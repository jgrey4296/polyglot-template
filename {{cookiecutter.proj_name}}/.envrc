#  .envrc -*- mode: sh -*-
# See https://direnv.net/
# export VAR=VAL
# PATH_add val

# venv location
if [[ -z "$READTHEDOCS" ]]; then
    export UV_PROJECT_ENVIRONMENT="$PWD/.temp/venv"
else
    # readthedocs uses its own location
    export UV_PROJECT_ENVIRONMENT="$READTHEDOCS_VIRTUALENV_PATH"
fi
if [[ -d "$UV_PROJECT_ENVIRONMENT" ]]; then
    source "$UV_PROJECT_ENVIRONMENT/bin/activate"
fi

# user local
PATH_add "$HOME/.local/bin"

# asdf
# This allows you to just install direnv, then direnv allow,
# to install the other plugins
if [[ -e ".asdf.plugins" ]]; then
    echo "Adding ASDF Plugins"
    while read -r pname url; do
        if [[ -n "$pname" ]]; then
            asdf plugin add "$pname" "${url:-}"
        fi
    done < ".asdf.plugins"
fi
asdf install
asdf reshim

# For JVM setup
source "$SDKMAN_DIR/bin/sdkman-init.sh"
sdk env > /dev/null

# For Android:
PATH_add "$ANDROID_HOME/cmdline-tools/latest/bin"
PATH_add "$ANDROID_HOME/platform-tools"

# For dotnet
PATH_add DOTNET_ROOT=$(asdf where dotnet)
PATH_add "$DOTNET_CLI_HOME/.dotnet/tools"

# latex
PATH_add "$TEXBASE/bin/x86_64-linux"

# for ruby
PATH_add $(gem environment user_gemhome)/bin
PATH_add $(gem environment gemdir)/bin

# For Ocaml/Rocq:
eval $(opam env)

# For repo-local tasks
PATH_add "$PWD/.tasks"

# For polyglot glue.
export POLYGLOT_ROOT="$PWD"

# Pre-commit skipping:
# export SKIP=""
